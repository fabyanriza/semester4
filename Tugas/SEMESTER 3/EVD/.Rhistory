data(gapminder,package="gapminder")
install.packages("gapminder")
install.packages("gapminder")
setwd("D:/KULIAH/Tugas/SEMESTER 3/EVD")
library(readr)
library(readr)
df=read_csv("plane.csv")
library(readr)
df=read_csv("plane.csv")
head(df)
library(dplyr)
df_clear<-select(df,-c("Date_of_Journey","Route","Dep_Time","Arrival_Time","Duration","Additional_Info"))
head(df_clear)
missing_values_per_column <- colSums(is.na(df_clear))
missing_values_per_column
library(corrplot)
library(corrplot)
install.packages("corrplot")
library(corrplot)
corrplot(cor(df_encoding),
order = "hclust",
tl.col="black",
tl.srt=45,
method = "number")
library(CatEncoders)
install.packages("CatEncoders")
library(CatEncoders)
df_encoding<-data.frame(df_clear)
labs1 = LabelEncoder.fit(df_encoding$Airline)
labs2 = LabelEncoder.fit(df_encoding$Source)
labs3 = LabelEncoder.fit(df_encoding$Destination)
df_encoding$Airline <- transform(labs1, df_encoding$Airline)
df_encoding$Source <- transform(labs2, df_encoding$Source)
df_encoding$Destination <- transform(labs3, df_encoding$Destination)
df_encoding
library(corrplot)
corrplot(cor(df_encoding),
order = "hclust",
tl.col="black",
tl.srt=45,
method = "number")
library(dplyr)
library(ggplot2)
library(ggrepel)
install.packages("ggrepel")
library(ggrepel)
a<-ggplot(df, aes(`Price(Rupee)`))+
geom_histogram(aes(y = ..density..),
fill = "#EEDD82",
alpha=0.8)+
geom_density(color='black',lwd=0.5)+
labs(title="Distribusi Biaya Asuransi (Charges)")+
theme(plot.title = element_text(hjust = 0.8))
setwd("D:/KULIAH/Tugas/SEMESTER 3/EVD")
library(readr)
library(readr)
df=read_csv("plane.csv")
head(df)
setwd("D:/KULIAH/Tugas/SEMESTER 3/EVD")
library(readr)
df=read_csv("plane.csv")
head(df)
library(dplyr)
df_clear<-select(df,-c("Date_of_Journey","Route","Dep_Time","Arrival_Time","Duration","Additional_Info"))
head(df_clear)
missing_values_per_column <- colSums(is.na(df_clear))
missing_values_per_column
library(CatEncoders)
df_encoding<-data.frame(df_clear)
labs1 = LabelEncoder.fit(df_encoding$Airline)
labs2 = LabelEncoder.fit(df_encoding$Source)
labs3 = LabelEncoder.fit(df_encoding$Destination)
df_encoding$Airline <- transform(labs1, df_encoding$Airline)
df_encoding$Source <- transform(labs2, df_encoding$Source)
df_encoding$Destination <- transform(labs3, df_encoding$Destination)
df_encoding
library(corrplot)
corrplot(cor(df_encoding),
order = "hclust",
tl.col="black",
tl.srt=45,
method = "number")
library(dplyr)
library(ggplot2)
library(ggrepel)
plotdata<-df %>%
count(Airline) %>%
arrange(desc(Airline)) %>%
mutate(prop = round(n*100/sum(n),1),
lab.ypos=cumsum(prop)-0.5*prop)
ggplot(plotdata,aes(x="",y=prop, fill=Airline))+
geom_bar(width=1,
stat="identity",
color="black",
alpha=0.8)+
coord_polar('y', start=0,
direction=-1)+
theme_void()+
labs(title= "Proporsi Jumlah Tiket dari Setiap Maskapai")+
theme(plot.title = element_text(hjust = 0.8, vjust=-5))+
theme_void()+
scale_fill_brewer(palette = "Set3")+
geom_label_repel(aes(y = lab.ypos, label = paste(n, "(", prop, "%)")),
size = 3.5,nudge_x = 0.7)
ggplot(df, aes(y=Source, fill=Destination))+
geom_bar()+
labs(title="Penerbangan Maskapai India Selama 2019")+
scale_fill_brewer(palette = "Set3")
a<-ggplot(df, aes(`Price(Rupee)`))+
geom_histogram(aes(y = ..density..),
fill = "#EEDD82",
alpha=0.8)+
geom_density(color='black',lwd=0.5)+
labs(title="Distribusi Biaya Asuransi (Charges)")+
theme(plot.title = element_text(hjust = 0.8))
b<-ggplot (df, aes(y=`Price(Rupee)`)) +
geom_boxplot (fill = "#EEDD82",
alpha = 0.6,
outlier.size=2,
varwidth=TRUE) +
labs (title = "Charges distribution")
library(gridExtra)
grid.arrange(a, b, ncol = 2)
data <- data.frame(
Date = as.Date(df$Date_of_Journey, "%d/%m/%Y"),
Price = df$`Price(Rupee)`)
test = aggregate(`Price(Rupee)`~Date_of_Journey,df,mean)
# Create a line chart with multiple lines (one line per flight)
ggplot(test, aes(x = as.Date(Date_of_Journey, "%d/%m/%Y"), y = `Price(Rupee)`))+
geom_line(lwd=0.6, color="#EE2C2C") +
labs(
title = "Line Chart of Price Over Time for Multiple Flights",
x = "Date",
y = "Price")
plotdata5 <- df%>%
group_by(Total_Stops)%>%
summarize(max=max(`Price(Rupee)`))
a1<-ggplot(plotdata5, aes(x=Total_Stops, y=max))+
geom_bar(stat="identity", fill="lightskyblue")+
labs(title="Price(Rupee) vs Total Stops",
y= "Price(Rupee)")
b1<-ggplot(df, aes(x=`Duration(Hour)`, y=`Price(Rupee)`))+
geom_point(color="#FFA07A", size=1.3)+
labs(title="Price(Rupee) vs Duration (Hour)")
library(gridExtra)
grid.arrange(a1, b1, ncol = 2)
ggplot(df,aes(x=`Price(Rupee)`,y=Airline))+
geom_boxplot(alpha=.7,  outlier.size=1, color="#CD2626")+
labs(title = "Price distribution by Airline")
